# Get User Example
# Demonstrates GET request to retrieve user details

PreExec: |
  # PreExec script - executed after Define section
  # Available functions: set_var(), get_var(), faker, spec
  
  # Set variables using faker
  random_email = faker.email()
  set_var('test_email', random_email)
  
  # Set a custom variable
  set_var('pre_exec_timestamp', faker.iso8601())
  
  # Access spec to read the current configuration
  print(f"[PreExec] Endpoint: {spec.get('Endpoint', 'N/A')}")
  print(f"[PreExec] Generated email: {random_email}")

PostExec: |
  # PostExec script - executed after everything is done
  # Available functions: set_var(), get_var(), faker, spec
  
  # Get variables set earlier
  test_email = get_var('test_email')
  pre_timestamp = get_var('pre_exec_timestamp')
  
  print(f"[PostExec] Test email from PreExec: {test_email}")
  print(f"[PostExec] PreExec timestamp: {pre_timestamp}")
  
  # Access spec to read response data or configuration
  print(f"[PostExec] Method used: {spec.get('Method', 'N/A')}")
  
  # Generate and store new data for potential next requests
  set_var('post_exec_id', faker.uuid4())

Define:
  userId: "user_12345"

Method: GET
Endpoint: ${base_url}/api/v1/users/${userId}

QueryParams:
  include: profile,preferences
  format: json

Headers:
  Authorization: ${authorization_token}
  Accept: application/json
  X-Request-ID: ${fake.uuid4()}

Captures:
  userId: "@body jsonpath $.id"
  userName: "@body jsonpath $.name"
  userEmail: "@body jsonpath $.email"
  statusCode: "@status"

Asserts:
  "status code is 200": "@status |==| 200"
  "response has user id": "@body jsonpath $.id"
  "response has name": "@body jsonpath $.name"

Options:
  timeout: 30
  insecure: false
